{"ast":null,"code":"import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";import _inherits from\"@babel/runtime/helpers/inherits\";import React,{Component}from'react';import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import Text from\"react-native-web/dist/exports/Text\";import View from\"react-native-web/dist/exports/View\";import TextInput from\"react-native-web/dist/exports/TextInput\";import Button from\"react-native-web/dist/exports/Button\";import Image from\"react-native-web/dist/exports/Image\";import ScrollView from\"react-native-web/dist/exports/ScrollView\";import Share from\"react-native-web/dist/exports/Share\";import{BackHandle}from\"react-native-web/dist/index\";import Dimensions from\"react-native-web/dist/exports/Dimensions\";import TouchableOpacity from\"react-native-web/dist/exports/TouchableOpacity\";import Comment from\"../Comment\";import firebase from'firebase';import{Icon}from'react-native-elements';import MenuButton from\"../components/MenuButton\";import SitesCatalog from\"./SitesCatalog\";import Input from\"../actions/Input\";import{NavigationActions,StackActions}from\"react-navigation\";var _Dimensions$get=Dimensions.get('window'),height=_Dimensions$get.height,width=_Dimensions$get.width;var comments_page=function(_Component){_inherits(comments_page,_Component);function comments_page(props){var _this;_classCallCheck(this,comments_page);_this=_possibleConstructorReturn(this,_getPrototypeOf(comments_page).call(this,props));_this.listenForNotitas=function(commentsRef){commentsRef.on('value',function(dataSnapshot){var aux=[];dataSnapshot.forEach(function(child){child.val().pageNo==_this.state.pageNo?aux.push({created_at:child.val().created_at,profile_picture:child.val().profile_picture,name:child.val().name,userID:child.val().userID,content:child.val().content,id:child.key}):null;});_this.setState({all_comments:aux});});};_this.deleteAction=function(key){console.log(key);return firebase.database().ref('comments').child(''+key).remove();};_this.ShareStuff=function(title,message,url){Share.share({title:title,message:title+':'+message+' '+url,url:url},{dialogTitle:'shate'+title});};_this.navigateToStory=function(){var pushAction=StackActions.push({routeName:'StoryList',params:{pageNo:3}});_this.props.navigation.dispatch(pushAction);};_this.state={moveToStory:_this.props.navigation.state.params.moveToStory,name:_this.props.navigation.state.params.name,photoUrl:_this.props.navigation.state.params.photoUrl,userID:_this.props.navigation.state.params.userID,pageNo:_this.props.navigation.state.params.pageNo,siteImg:_this.props.navigation.state.params.siteImg,showMenuButtom:false,comment_text:'',all_comments:[]};return _this;}_createClass(comments_page,[{key:\"componentWillMount\",value:function componentWillMount(){pageNo=this.props.navigation.state.params.pageNo;var commentsRef=firebase.database().ref('comments');this.listenForNotitas(commentsRef);}},{key:\"isOwner\",value:function isOwner(userID){if(this.state.userID==userID){return true;}else return false;}},{key:\"submitComment\",value:function submitComment(content){firebase.database().ref('/comments/').push({profile_picture:this.state.photoUrl,name:this.state.name,created_at:Date.now(),userID:this.state.userID,content:content,pageNo:this.state.pageNo});}},{key:\"render\",value:function render(){var _this2=this;var DBcommentsList=this.state.all_comments.map(function(data,key,val){return React.createElement(Comment,{key:key,username:data.name,image:data.profile_picture,userID:data.userID,isOwner:_this2.isOwner.bind(_this2),canEdit:_this2.isOwner.bind(_this2),created_at:data.created_at,body:data.content,id:data.id,deleteAction:_this2.deleteAction.bind(_this2)});});return React.createElement(ScrollView,null,React.createElement(MenuButton,{navigation:this.props.navigation,showIcon:this.state.showMenuButtom}),this.state.moveToStory?React.createElement(TouchableOpacity,{style:styles.buttonStyle,onPress:this.navigateToStory},React.createElement(Text,{style:styles.buttontextStyleShort},\" \\u05DC\\u05DE\\u05E2\\u05D1\\u05E8 \\u05DC\\u05E1\\u05D9\\u05E4\\u05D5\\u05E8\")):React.createElement(Text,null),React.createElement(View,{style:{flex:1,width:\"100%\",height:\"100%\"}},React.createElement(Image,{style:{height:350,width:width},source:this.state.siteImg}),React.createElement(ScrollView,{style:{backgroundColor:\"#FFFFFF\"}},React.createElement(Icon,{raised:true,reverse:true,name:\"share\",type:\"font-awesome\",color:\"#51D2A8\",onPress:function onPress(){return _this2.ShareStuff('IM Title ','Im content','Im photo');}}),React.createElement(Input,{onSubmit:this.submitComment.bind(this)}),React.createElement(ScrollView,null,DBcommentsList))));}}]);return comments_page;}(Component);export default comments_page;var styles=StyleSheet.create({container:{flex:1,alignContent:'center',justifyContent:'center'},buttonStyle:{zIndex:9,position:'absolute',top:40,left:20,flex:1,alignSelf:'center',backgroundColor:'#f1f3f6',borderWidth:1,borderColor:'gainsboro',borderTopRightRadius:20,borderTopLeftRadius:20,borderBottomRightRadius:20,borderBottomLeftRadius:20},buttontextStyleShort:{fontSize:14,fontWeight:'900',paddingTop:6,paddingBottom:6,color:'black',textAlign:'center',fontStyle:'italic'}});","map":{"version":3,"sources":["C:/final project/react native/finalProject-master/screens/comments_page.js"],"names":["React","Component","BackHandle","Comment","firebase","Icon","MenuButton","SitesCatalog","Input","NavigationActions","StackActions","Dimensions","get","height","width","comments_page","props","listenForNotitas","commentsRef","on","dataSnapshot","aux","forEach","child","val","pageNo","state","push","created_at","profile_picture","name","userID","content","id","key","setState","all_comments","deleteAction","console","log","database","ref","remove","ShareStuff","title","message","url","Share","share","dialogTitle","navigateToStory","pushAction","routeName","params","navigation","dispatch","moveToStory","photoUrl","siteImg","showMenuButtom","comment_text","Date","now","DBcommentsList","map","data","isOwner","bind","styles","buttonStyle","buttontextStyleShort","flex","backgroundColor","submitComment","StyleSheet","create","container","alignContent","justifyContent","zIndex","position","top","left","alignSelf","borderWidth","borderColor","borderTopRightRadius","borderTopLeftRadius","borderBottomRightRadius","borderBottomLeftRadius","fontSize","fontWeight","paddingTop","paddingBottom","color","textAlign","fontStyle"],"mappings":"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","sourcesContent":["import React ,  {Component} from 'react';\nimport { StyleSheet, Text, View,TextInput,Button,Image,ScrollView ,Share,BackHandle,Dimensions,TouchableOpacity} from 'react-native';\nimport Comment from '../Comment'\nimport firebase from 'firebase'\nimport { Icon } from 'react-native-elements'\nimport MenuButton from  '../components/MenuButton'\nimport SitesCatalog from './SitesCatalog'\nimport Input from '../actions/Input'\nimport { NavigationActions,StackActions } from \"react-navigation\";\nconst {height, width} = Dimensions.get('window');\n// import { Icon } from 'react-native-vector-icons/Icon';\n// import Comments from \"react-native-comments\";\nclass comments_page extends Component {\n    constructor(props){\n        \n        super(props);\n        this.state = {\n            moveToStory : this.props.navigation.state.params.moveToStory,\n            name: this.props.navigation.state.params.name,\n            photoUrl: this.props.navigation.state.params.photoUrl,\n            userID: this.props.navigation.state.params.userID,\n            pageNo: this.props.navigation.state.params.pageNo,\n            siteImg:this.props.navigation.state.params.siteImg,\n            showMenuButtom: false,\n            comment_text: '',\n            all_comments: []\n        }\n        \n\n    }\n\n    componentWillMount() {\n        pageNo = this.props.navigation.state.params.pageNo\n        const commentsRef = firebase.database().ref('comments');\n        this.listenForNotitas(commentsRef);\n      };\n  \n      listenForNotitas = (commentsRef) => {\n        commentsRef.on('value', (dataSnapshot) => {\n          var aux = [];\n          dataSnapshot.forEach((child) => {\n            child.val().pageNo == this.state.pageNo ?\n              aux.push({\n                created_at: child.val().created_at,\n                profile_picture: child.val().profile_picture,\n                name : child.val().name,\n                userID :child.val().userID,\n                content :child.val().content,\n                id: child.key\n              }) : null\n            });\n          this.setState({all_comments: aux});\n        });\n      };  // listenForNotitas\n       \n      deleteAction = (key) => {\n        console.log(key)\n        return firebase.database().ref('comments').child('' + key).remove();\n    }\n    isOwner(userID){\n        if(this.state.userID ==userID ){return true}\n        else return false;\n     }\n    submitComment(content){\n        //console.log('photo: ',this.state.photoUrl)\n        firebase.database().ref('/comments/').push({\n            profile_picture: this.state.photoUrl,\n            name: this.state.name,\n            created_at: Date.now(),\n            userID:this.state.userID,\n            content: content,\n            pageNo: this.state.pageNo\n        })\n    }\n      \n    \n   ShareStuff = (title,message,url) =>{\n      Share.share({\n        title: title,\n        message: title + ':' + message + ' ' + url ,\n        url: url\n      }, {dialogTitle: 'shate' + title});\n    }\n    navigateToStory = () => {\n      \n      const pushAction = StackActions.push({\n        routeName: 'StoryList',\n        params: {\n\n          pageNo:3,\n\n        }\n        });\n        this.props.navigation.dispatch(pushAction);\n    }\n\n    render(){\n        \n        const DBcommentsList = this.state.all_comments.map((data,key,val) => {\n             return (\n                <Comment\n                 key={key}\n                 username = {data.name}\n                 image= {data.profile_picture}\n                 userID = {data.userID}\n                 isOwner= {this.isOwner.bind(this)}\n                 canEdit = {this.isOwner.bind(this)}\n                 created_at = {data.created_at}\n                 body = {data.content}\n                 id = {data.id}\n                 deleteAction = {this.deleteAction.bind(this) }\n                 \n                 \n                 \n                  ></Comment>\n\n            );\n          }\n         \n          );\n      \n        return(  \n                  <ScrollView>\n                    <MenuButton navigation={this.props.navigation} showIcon = {this.state.showMenuButtom} />\n                    {this.state.moveToStory?\n                               ( <TouchableOpacity style={styles.buttonStyle} onPress = { this.navigateToStory}>\n                                          <Text style={styles.buttontextStyleShort}> למעבר לסיפור</Text>\n                                        </TouchableOpacity>):(<Text></Text>) }\n                    <View style={{flex:1,width:\"100%\",height:\"100%\"}} >\n                        <Image\n                      style={{ height:350, width:width}}\n                      source={ this.state.siteImg}\n                        />\n                        <ScrollView style={{ backgroundColor: \"#FFFFFF\" }}>\n\n                            \n                            \n                            \n                            <Icon\n                              raised\n                              reverse\n                              name='share'\n                              type='font-awesome'\n                              color='#51D2A8'\n                              onPress={() => this.ShareStuff('IM Title ','Im content','Im photo')}\n\n                            />\n                            \n                            \n                            <Input onSubmit={this.submitComment.bind(this)} />\n                            <ScrollView >\n                              {DBcommentsList}\n                            </ScrollView>\n                            \n                          </ScrollView>\n                      </View>\n                    </ScrollView>\n        )\n      \n    }\n}\nexport default comments_page;\n\nconst styles = StyleSheet.create({\n    container:{\n        flex:1,\n        alignContent:'center',\n        justifyContent:'center'\n\n    },\n    buttonStyle: {\n      zIndex: 9,\n      position: 'absolute',\n      top: 40,\n      left: 20,\n\t\t  \n      flex:1,\n      alignSelf: 'center',\n      backgroundColor: '#f1f3f6',\n      borderWidth:1,\n      borderColor:'gainsboro',\n      borderTopRightRadius: 20,\n      borderTopLeftRadius: 20,\n      borderBottomRightRadius: 20,\n      borderBottomLeftRadius: 20,\n    },\n    \n    buttontextStyleShort: {\n      fontSize: 14,\n      fontWeight: '900',\n      paddingTop: 6,\n      paddingBottom:6,\n      color:'black',\n      textAlign: 'center',\n      fontStyle:  'italic'\n    },\n})"]},"metadata":{},"sourceType":"module"}